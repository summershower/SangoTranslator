"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[447],{24601:function(w,u,i){i.r(u),i.d(u,{default:function(){return v}});var r=i(30279),f=i.n(r),s=i(93236),a=i(2773),c={lang:"zh",container:"sheetContainer",showinfobar:!1,data:[{name:"Sheet1"}],showtoolbarConfig:{undoRedo:!0,paintFormat:!0,currencyFormat:!1,percentageFormat:!1,numberDecrease:!1,numberIncrease:!1,moreFormats:!1,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,mergeCell:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!1,image:!1,link:!1,chart:!1,postil:!0,pivotTable:!1,function:!1,frozenMode:!0,sortAndFilter:!1,conditionalFormat:!1,dataVerification:!1,splitColumn:!1,screenshot:!1,findAndReplace:!0,protection:!0,print:!1},cellRightClickConfig:{copy:!0,copyAs:!0,paste:!0,insertRow:!0,insertColumn:!0,deleteRow:!0,deleteColumn:!0,deleteCell:!0,hideRow:!1,hideColumn:!1,rowHeight:!1,columnWidth:!1,clear:!0,matrix:!1,sort:!1,filter:!1,chart:!1,image:!1,link:!1,data:!1,cellFormat:!1},showstatisticBarConfig:{count:!0,view:!1,zoom:!0},hook:{updated:function(){(0,a.Pj)(window.luckysheet.getAllSheets())},sheetActivate:function(){setTimeout(function(){(0,a.Pj)(window.luckysheet.getAllSheets())},0)}}},p=i(62086),d=function(){var g=(0,s.useRef)(null);function m(){(0,a.zK)().then(function(){var e=f()({},c);console.log(e),(0,a.ij)().then(function(t){t&&(e.data=t),window.luckysheet.create(e)})}).catch(function(){window.luckysheet.create(c)})}return(0,s.useEffect)(function(){var e=document.querySelector(".ant-pro-layout-content");return e==null||e.classList.add("noPadding"),m(),function(){e==null||e.classList.remove("noPadding")}},[]),(0,p.jsx)("div",{style:{width:"100%",height:"100vh"},id:"sheetContainer",ref:g})},v=d},2773:function(w,u,i){i.d(u,{Pj:function(){return v},ij:function(){return d},pJ:function(){return g},yH:function(){return m},zK:function(){return c}});var r="sheet",f="SangoTranslator",s=1,a;function c(){return new Promise(function(e,t){var o=window.indexedDB.open(f,s);o.onupgradeneeded=function(n){var l;a=n==null||(l=n.target)===null||l===void 0?void 0:l.result,a.objectStoreNames.contains(r)||a.createObjectStore(r)},o.onsuccess=function(n){var l;a=n==null||(l=n.target)===null||l===void 0?void 0:l.result,e(!0),console.log("DB\u8FDE\u63A5\u6210\u529F")},o.onerror=function(n){t(!1),console.log(n,"DB\u8FDE\u63A5\u5931\u8D25")}})}function p(e){var t=a.transaction(r,"readwrite").objectStore(r).add(e,"main");t.onsuccess=function(){console.log("\u5199\u5165",t.result)},t.onerror=function(o){console.log(o,"\u5199\u5165\u5931\u8D25")}}function d(){return new Promise(function(e){var t=a.transaction(r).objectStore(r).get("main");t.onsuccess=function(o){var n;e(o==null||(n=o.target)===null||n===void 0?void 0:n.result)}})}function v(e){var t=a.transaction(r,"readwrite").objectStore(r).put(e,"main");t.onsuccess=function(){console.log("\u4FEE\u6539\u6210\u529F",t.result)},t.onerror=function(o){console.log(o,"\u4FEE\u6539\u5931\u8D25")}}function h(e){var t=a.transaction(r,"readwrite").objectStore(r).delete(e);t.onsuccess=function(){console.log("\u5220\u9664\u6210\u529F",t.result)},t.onerror=function(o){console.log(o,"\u5220\u9664\u5931\u8D25")}}function g(){return new Promise(function(e){var t=a.transaction(r).objectStore(r).getAll();t.onsuccess=function(o){var n;e(o==null||(n=o.target)===null||n===void 0?void 0:n.result)}})}function m(e){var t=a.transaction(r,"readwrite").objectStore(r).put(e,e.sheetId);t.onsuccess=function(){console.log("\u50A8\u5B58\u6587\u4EF6\u6210\u529F",t.result)},t.onerror=function(o){console.log(o,"\u50A8\u5B58\u6587\u4EF6\u5931\u8D25")}}}}]);
